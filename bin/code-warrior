#!/usr/bin/env node

var CodeWarrior = require('../lib'),
    nopt = require('nopt'),
    knownOpts = {
      'level': ['basic', 'moderate', 'hard'],
      'help': [Boolean],
      'url': [String],
      'stage': [Number],
    } , shortHands = {
      'l': ['--level'],
      'h': ['--help'],
      's': ['--stage'],
      'u': ['--url']
    }

try {
  var package = require(process.cwd() + '/package.json');
} catch (e) {
  console.log('please init the project');
  return;
}

if (!package.id) {
  console.log('please login');
  return;
}

var parsed = nopt(knownOpts, shortHands, process.argv, 2);

var command = parsed.argv.remain.shift() || 'test';

parsed.url = parsed.url || process.env.URL ||  'http://code-warrior.herokuapp.com';

if(Object.keys(CodeWarrior.commands).indexOf(command) !== -1) {
  CodeWarrior.commands[command](parsed);
} else {
  console.log('no command')
}
